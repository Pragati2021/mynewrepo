This is file 1. Modified from master branch.